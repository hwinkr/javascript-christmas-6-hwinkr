# 🎄 우테코 식당 크리스마스 프로모션 🎄

우테코 식당에서 크리스마스를 기념하여 이벤트를 진행하기로 결정했고

1. 식당 방문 날짜
2. 주문할 메뉴

2개의 정보를 통해서 이벤트 결과를 미리 확인할 수 있는 **이벤트 플래너**를 개발하기로 했습니다.

## 어떤 메뉴를 주문할 수 있나요?

```
🍔🥗🍝🍪🍅
<애피타이저> appetizer
양송이수프(6,000), 타파스(5,500), 시저샐러드(8,000)

<메인> main
티본스테이크(55,000), 바비큐립(54,000), 해산물파스타(35,000), 크리스마스파스타(25,000)

<디저트> dessert
초코케이크(15,000), 아이스크림(5,000)

<음료> beverage
제로콜라(3,000), 레드와인(60,000), 샴페인(25,000)
```

위 메뉴판에 있는 메뉴들을 주문할 수 있고, 주문하실 때는 다음과 같은 규칙들을 지켜주셔야 합니다!

1. 음료만 주문할 수 없습니다.
2. 총 주문 수량이 20개 이하가 되도록 주문해주셔야 합니다.
3. 중복 메뉴를 주문할 수 없습니다.

## 어떤 혜택이 있나요?

![image](https://github.com/hwinkr/javascript-christmas-6-hwinkr/assets/68489467/e4425419-3a64-4b46-94b4-08b4814a0300)

1. 크리스마스 디데이 할인

- 이벤트 기간: 2023.12.1 ~ 2023.12.25
- 1,000원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가
- 총주문 금액에서 해당 금액만큼 할인(e.g. 시작일인 12월 1일에 1,000원, 2일에 1,100원, ..., 25일엔 3,400원 할인)

2. 평일 할인(일요일~목요일)

- 평일에는 디저트 메뉴를 메뉴 1개당 2,023원 할인

3. 주말 할인(금요일, 토요일)

- 주말에는 메인 메뉴를 메뉴 1개당 2,023원 할인

4. 특별 할인

- 이벤트 달력에 별이 있으면 총주문 금액에서 1,000원 할인

5. 증정 이벤트

- **할인 전 총주문 금액**이 12만 원 이상일 때, 샴페인 1개 증정

* 주의 사항 : **'크리스마스 디데이 할인'을 제외한 다른 이벤트는 2023.12.1 ~ 2023.12.31 동안 적용**

위와 같이 정말 많은 혜택이 있으니 많은 이용 부탁드립니다!🙇‍♂️

## 어떻게 이용할 수 있나요?

식당 방문 날짜와 주문하실 메뉴만 알려드리면 고객님들께서 받을 수 있는 혜택 정보를 미리 알려드립니다!
정말 간편하게 혜택들을 확인하실 수 있어요! 😊
간단한 예시들을 보여드리도록 하겠습니다!

![image](https://github.com/hwinkr/javascript-christmas-6-hwinkr/assets/68489467/f86921d9-2552-40d8-b48f-62c79f7a08aa)

![image](https://github.com/hwinkr/javascript-christmas-6-hwinkr/assets/68489467/c7666bca-78b3-4180-a498-3bce771273eb)

# 우테코 식당 크리스마스 프로모션을 구현하기 위한 기능 명세서

## 해결해야 하는 현실 문제

기능 요구 사항을 모두 읽은 후, 해결해야 하는 현실 문제를 요약해서 정리했습니다

> 12월 N일에 사용자가 우테코 식당에 방문하기 위해 예약을 하려고 한다.
> 주문 정보(음식 메뉴, 주문 수량)를 입력 했을 때, 사용자는 어떤 이벤트 혜택을 얻을 수 있나?

# 설계도

![image](https://github.com/hwinkr/javascript-christmas-6-hwinkr/assets/68489467/bf7162c7-eb07-4017-ab7a-2ff730bf3111)

# Domain

## 1. `Menu`

> `Menu` 도메인은 사용자가 주문한 메뉴 하나를 표현합니다.
> Menu의 타입에 따라서 평일, 주말 할인이 적용되는지 되지 않는지가 결정되기 때문에
> Menu의 타입을 구하고 타입에 따라서 할인 여부를 결정하는 것을 `Menu` 도메인 로직으로 구현하기로 했습니다.

### Menu 도메인에 대한 고민

평일, 주말에 영향을 받는 메뉴(디저트, 메인)과 평일, 주말에 영향을 받지 않는 메뉴를 구분해서 클래스를 만드는 것은 어떨까에 대해 고민했습니다.

→ 평일, 주말에 영향을 받는 메뉴를 클래스로 표현했을 경우 할인 가격을 계산하는 도메인 로직이 포함되겠지만 영향을 받지 않는 메뉴를 클래스로 표현했을 경우 getter, setter 역할밖에 하지 않을 것 같다는 생각을 했습니다. 이 메뉴들은 평일, 주말에 대해서 추가 할인이 없기 때문에 할인과 관련된 도메인 로직이 없을 것이고 오직 데이터(메뉴 이름, 메뉴 타입, 메뉴 수량)만 가질 것이기 때문에 객체는 일을 하지 않고 데이터만 표현하게 됩니다. 3주차 공통 피드백에서도 확인할 수 있듯이, 이를 지양하기로 했습니다.

하지만 만약 평일, 주말에 영향을 받지 않는 메뉴들에 대해서 다른 할인이 적용되고 할인 로직이 평일, 주말에 영향을 받는 메뉴들과 다르다면 클래스 분리를 고민해볼 수 있을 듯 합니다.

- 메뉴는 **날짜로 결정되는 할인 정보**에 따라서, 할인이 달라진다. 날짜로 결정되는 할인 정보를 받아서 한 메뉴에 대해서 할인을 적용하는 것은 **메뉴 도메인의 책임으로 한다**.
- [x] 타입에 따라서 할인을 적용할지 말지 결정한다.
- [x] 메뉴의 타입, 할인 정보에 따라서 할인 결과(할인 금액)를 반환한다.
- [x] Menu 클래스는 메뉴의 타입을 구분한다.
- [x] 한 메뉴의 금액(한 메뉴의 가격 \* 주문 수량)을 계산한다.

## 2. ~~`Restaurant`~~ -> `Order`

> `Restaurant` 도메인은 주문을 받아서, 음식을 만드는 식당(우테코 식당 역할)을 표현합니다.
> 사용자의 주문에 대해서 유효성을 검증하고, 주문 정보에 따라 음식을 만들어주는 것을 `Restaurant` 의 도메인 로직으로 구현하기로 했습니다.

### `Restaurant` 도메인 이름 변경(2023.11.13)

도메인 이름을 `Restaurant`로 하고 도메인 로직을 구현하다보니, **우테코 식당** 보다 우테코 식당에서 하는 **주문**과 관련된 도메인 로직이 대부분이여서 도메인 이름을 `Order`로 변경하기로 했습니다.

- `Order`은 주문 정보에 따라 음식을 만들어주는 책임을 가짐
- [x] 사용자의 주문에 대한 유효성을 검증

- 고객이 메뉴판에 없는 메뉴를 입력하는 경우,
- 메뉴의 개수는 1 이상의 숫자가 아닌 경우
- 메뉴 형식이 예시와 다른 경우
- 중복 메뉴를 입력한 경우(e.g. 시저샐러드-1,시저샐러드-1)
- 음료만 주문한 경우
- 20개 이상의 메뉴를 주문한 경우

-> 예외를 발생시킨다.

- [x] 고객의 주문을 받아서 주문 메뉴 리스트(음식)를 생성한다.
- [x] 고객의 총주문 금액을 계산한다.
- [x] **날짜로 결정되는 할인 타입(평일, 주말)** 정보를 받아서 주문한 **메뉴에 대한** 할인을 계산한다.

## 3. `VisitDate`

> `VisitDate` 도메인은 사용자가 우테코 식당에 방문하는 날짜를 표현합니다.
> 방문 날짜에 따라서 할인 정보가 변하기 때문에, 날짜에 따라서 할인 정보를 구하는 것과 날짜에 대한 유효성을 검증하는 것을 `VisitDate` 도메인 로직으로 구현하기로 했습니다.

- [x] 날짜의 유효성을 검증한다.

- 날짜의 데이터 타입이 숫자가 아닌 경우
- 1 ~ 31 사이의 숫자가 아닌 경우

-> 예외를 발생 시킨다.

- [x] 날짜는 할인을 결정한다.(Date 도메인은 방문 날짜를 통해서 할인을 결정해야 할 책임이 있다.)

- 크리스마스 디데이 할인 금액 결정
- 평일, 주말 할인인지 결정
- 특별 할인이 가능한지 결정

## 4. `Gift` (2023.11.13)

> `Gift` 도메인은 증정 이벤트를 표현합니다. 할인 전 총주문 금액에 따라서 증정품 증정 여부가 결정 되므로, 증정품 증정 여부를 판단하는 것을 `Gift` 도메인 로직으로 구현하기로 했습니다.

- [x] 증점품 증정 여부를 판단한다.
- [x] 증정 이벤트 정보를 생성한다
- 증정품을 받는 경우

```js
this.#giftInfo = {
  name: '샴페인',
  quantity: 1,
};
```

- 증정품을 받지 못하는 경우

```js
this.#giftInfo = {
  name: '샴페인',
  quantity: 0,
};
```

증정품을 받지 못하는 경우에도 `quantity`가 0인 증정 이벤트 정보를 생성하는 이유는, 출력을 담당하는 `OutputView`에서 증정 이벤트 정보 데이터를 받아서 어떻게 출력할지 결정할 수 있도록 하기 위해서 입니다. 만약, 기획이 변경되어 증정품을 증정하지 않더라도 `샴페인 -0개` 처럼 출력해야 하는 경우에 유연하게 대처할 수 있기 때문에 증정품이 없는 경우에도 증정 이벤트 정보를 생성하도록 결정했습니다.

## 5. Bedge

> `Bedge` 도메인은 12월 이벤트 배지를 표현합니다. 총 혜택 금액에 따라서 12월 이벤트 배지가 결정 되므로, 배지를 결정하는 것을 `Bedge` 도메인 로직으로 구현하기로 했습니다.

- [x] 총 혜택 금액에 대한 12월 이벤트 배지를 결정한다.

# Service

기능 요구 사항 중,

```
<혜택 내역>
크리스마스 디데이 할인: -1,200원
평일 할인: -4,046원
특별 할인: -1,000원
증정 이벤트: -25,000원
```

혜택 내역을 어떻게 만들어야 할까에 대한 고민을 했습니다. 혜택 내역은 우테코 식당에 방문하는 날짜, 주문하는 메뉴들, 할인 전 총주문 금액에 모두 영향을 받기 때문에 **이미 구현된, 도메인 로직들을 합친**새로운 로직을 구현해야겠다고 판단했습니다.

## DiscountService

> 혜택 내역 중 크리스마스 디데이 할인, 평일 할인, 특별 할인은 우테코 식당 방문 날짜와 주문하는 메뉴들에 의해서 결정됩니다. 따라서, `VisitDate`, `Order`, `Menu`의 도메인 로직들을 합쳐 할인 정보를 만드는 새로운 도메인 로직을 구현하기로 했습니다.

- [x] `VisitDate`의 도메인 로직을 사용해 크리스마스 디데이 할인 정보를 생성한다.
- [x] `VisitDate`의 평일 or 주말 할인을 결정하는 도메인 로직, `Order`의 모든 메뉴들에 대한 할인을 계산하는 도메인 로직을 사용해 평일 or 주말 할인 정보를 생성한다.
- [x] `VisitDate`의 특별 할인을 확인하는 도메인 로직을 활용해 특별 할인 정보를 생성한다.
- [x] `VisitDate`, `Order`의 도메인 로직을 외부에서 사용할 수 있도록 메서드를 구현한다.

## EventPlanner

> 전체 혜택 정보를 생성하기 위해서는 증정 이벤트에 대한 판단을 하는 `Gift` 도메인도 필요합니다. 따라서, `DiscountService`, `Gift`의 도메인 로직을 사용해서 전체 혜택 정보를 생성하는 `EventPlanner`를 구현하기로 했습니다. 그리고 `EventPlanner`는 크리스마스 프로모션 문제를 해결하기 위한 모든 도메인을 가지고 있으므로, 구현된 도메인 로직을 외부에서 호출할 수 있도록 메서드를 구현해야 합니다.

- [x] `DiscountService`, `Gift`의 도메인 로직을 사용해 전체 혜택 내역 정보를 생성한다
- [x] `DiscountService`, `Gift`, `Bedge`의 도메인 로직을 외부에서 사용할 수 있도록 메서드를 구현한다.

# EventController

> 도메인 로직과 UI로직을 연결하기 위해서 컨트롤러를 구현하기로 했습니다.`EventPlanner`, `InputView`, `OutputView`를 사용해 크리스마스 프로모션 문제를 해결하기 위한 명령을 전합니다.

- [ ] `InputView`에 입력을 받아 `EventPlanner`에 전달한다.
- [ ] `EventPlanner`가 전달한 문제 해결 결과를 `OutputView`에 전달해 출력하도록 명령을 전달한다.

# UI

## InputView

- [ ] 방문 날짜 입력받기
- [ ] 주문 메뉴 입력받기

## OutputView

- [ ] 주문 메뉴 출력하기
- [ ] 할인 전 총주문 금액, 증정 메뉴, 혜택 내역, 총혜택 금액, 할인 후 예상 결제 금액, 12월 이벤트 배지 출력하기

# 기타

- [ ] [고객에게 안내할 이벤트 주의 사항](https://github.com/hwinkr/javascript-christmas-6-hwinkr#%EA%B3%A0%EA%B0%9D%EC%97%90%EA%B2%8C-%EC%95%88%EB%82%B4%ED%95%A0-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EC%A3%BC%EC%9D%98-%EC%82%AC%ED%95%AD)을 어떻게 활용할지 결정하기

  - 출력 메세지로 활용?
  - 유효성 검사에 활용?

- [x] 객체 불변성을 유지할 수 있도록 `deepFreeze` 유틸함수 구현하기
- [x] 크리스마스 이벤트와 관련된 메시지들을 상수 객체로 설정하기
